def getDockerTag(){
        def tag = sh script: 'git rev-parse HEAD', returnStdout: true
        return tag
        }
        

pipeline{
        agent any  
        environment{
	    Docker_tag = getDockerTag()
        }
        
        stages{

		    sh "mvn clean install"



              stage('build')
                {
              steps{
                  script{
		  sh 'cp -r ../devops-training@2/target .'
                  sh 'docker build . -t kishornandhu/devops-training:$Docker_tag'
				 
				  sh 'docker push kishornandhu/devops-training:$Docker_tag'
                       }
                    }
                 }		
               }     	     
}
